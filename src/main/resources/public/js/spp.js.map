{"version":3,"file":"spp.js","names":["baseUrl","registerUrl","loginUrl","loginsuccess","processForm","action","form","entity","classList","contains","checkValidity","url","id","value","data","fData","FormData","JSON","stringify","Object","fromEntries","requestHeader","localStorage","getItem","options","method","headers","body","fetch","then","res","ok","alert","status","location","href","text","json","setItem","message","editModal","hide","$","DataTable","ajax","reload","Promise","resolve","loadField","fieldId","array","remove","i","selected","code","append","logout"],"sources":["../../src/js/spp.js"],"sourcesContent":["var baseUrl = \"/api/v1/\";\nvar registerUrl = \"/auth/addNewUser\";\nvar loginUrl = \"/auth/generateToken\";\n\nvar loginsuccess = false;\nfunction processForm(action, form, entity) {\n    loginsuccess = false;\n    if (action == 'GET' || (form.classList.contains('was-validated') && form.checkValidity())) {\n        let url = baseUrl + entity;\n        if (entity == 'register') url = registerUrl;\n        if (entity == 'login') url = loginUrl;\n        if (action == 'PUT') {\n            url += '/' + form.id.value;\n        }\n        let data = '';\n\n        if (form != null) {\n            let fData = new FormData(form);\n            data = JSON.stringify(Object.fromEntries(fData));\n        }\n\n        let requestHeader = {\n            \"Content-Type\": \"application/json\",\n        };\n        if (entity != 'login' && entity != 'register') {\n            requestHeader = {\n                'crossorigin': true,\n                'Access-Control-Allow-Origin': '*',\n                \"Content-Type\": \"application/json\",\n                \"Authorization\": \"Bearer \" + localStorage.getItem(\"accesstoken\")\n            };\n        }\n        let options = {\n            method: action,\n            headers: requestHeader,\n            body: data\n        };\n        if (action == 'GET') delete options.body;\n        fetch(url, options).then((res) => {\n            if (res.ok && action != 'GET') alert('Thành công');\n            if (res.status > 299) location.href = \"/login.html\";\n            if (res.ok && entity == 'login') {\n                loginsuccess = true;\n                return res.text();\n            }\n            return res.json();\n        }).then(res => {\n            if (entity == 'login' && loginsuccess) {\n                localStorage.setItem(\"accesstoken\", res);\n                location.href = '/base/list-jobs.html';\n            }\n            if (res.message) alert(res.message);\n            if (action == 'PUT') {\n                editModal.hide();\n                $('#example').DataTable().ajax.reload();\n            } \n            return Promise.resolve(res);\n        }).then(res => {\n            if (action == 'GET'){\n                switch (entity) {\n                    case 'employees':\n                        loadField('employeeCode', res,null);\n                        break;\n                    default:\n                        break;\n                }\n            } \n        });\n    }\n}\nfunction loadField(fieldId, array, value) {\n    $(\"#\" + fieldId + ' option').remove(0);\n    for (i in array) {\n        let selected='';\n        if(value !=null && array[i].code==value) selected='selected'\n        $(\"#\" + fieldId).append(\"<option value='\"+array[i].code+\"' \"+selected+\">\" + array[i].code + \"</option>\");\n    }\n}\nfunction logout() {\n    localStorage.setItem(\"accesstoken\", \"\");\n}\n"],"mappings":"AAAA,IAAIA,OAAO,GAAG,UAAU;AACxB,IAAIC,WAAW,GAAG,kBAAkB;AACpC,IAAIC,QAAQ,GAAG,qBAAqB;AAEpC,IAAIC,YAAY,GAAG,KAAK;AACxB,SAASC,WAAWA,CAACC,MAAM,EAAEC,IAAI,EAAEC,MAAM,EAAE;EACvCJ,YAAY,GAAG,KAAK;EACpB,IAAIE,MAAM,IAAI,KAAK,IAAKC,IAAI,CAACE,SAAS,CAACC,QAAQ,CAAC,eAAe,CAAC,IAAIH,IAAI,CAACI,aAAa,CAAC,CAAE,EAAE;IACvF,IAAIC,GAAG,GAAGX,OAAO,GAAGO,MAAM;IAC1B,IAAIA,MAAM,IAAI,UAAU,EAAEI,GAAG,GAAGV,WAAW;IAC3C,IAAIM,MAAM,IAAI,OAAO,EAAEI,GAAG,GAAGT,QAAQ;IACrC,IAAIG,MAAM,IAAI,KAAK,EAAE;MACjBM,GAAG,IAAI,GAAG,GAAGL,IAAI,CAACM,EAAE,CAACC,KAAK;IAC9B;IACA,IAAIC,IAAI,GAAG,EAAE;IAEb,IAAIR,IAAI,IAAI,IAAI,EAAE;MACd,IAAIS,KAAK,GAAG,IAAIC,QAAQ,CAACV,IAAI,CAAC;MAC9BQ,IAAI,GAAGG,IAAI,CAACC,SAAS,CAACC,MAAM,CAACC,WAAW,CAACL,KAAK,CAAC,CAAC;IACpD;IAEA,IAAIM,aAAa,GAAG;MAChB,cAAc,EAAE;IACpB,CAAC;IACD,IAAId,MAAM,IAAI,OAAO,IAAIA,MAAM,IAAI,UAAU,EAAE;MAC3Cc,aAAa,GAAG;QACZ,aAAa,EAAE,IAAI;QACnB,6BAA6B,EAAE,GAAG;QAClC,cAAc,EAAE,kBAAkB;QAClC,eAAe,EAAE,SAAS,GAAGC,YAAY,CAACC,OAAO,CAAC,aAAa;MACnE,CAAC;IACL;IACA,IAAIC,OAAO,GAAG;MACVC,MAAM,EAAEpB,MAAM;MACdqB,OAAO,EAAEL,aAAa;MACtBM,IAAI,EAAEb;IACV,CAAC;IACD,IAAIT,MAAM,IAAI,KAAK,EAAE,OAAOmB,OAAO,CAACG,IAAI;IACxCC,KAAK,CAACjB,GAAG,EAAEa,OAAO,CAAC,CAACK,IAAI,CAAEC,GAAG,IAAK;MAC9B,IAAIA,GAAG,CAACC,EAAE,IAAI1B,MAAM,IAAI,KAAK,EAAE2B,KAAK,CAAC,YAAY,CAAC;MAClD,IAAIF,GAAG,CAACG,MAAM,GAAG,GAAG,EAAEC,QAAQ,CAACC,IAAI,GAAG,aAAa;MACnD,IAAIL,GAAG,CAACC,EAAE,IAAIxB,MAAM,IAAI,OAAO,EAAE;QAC7BJ,YAAY,GAAG,IAAI;QACnB,OAAO2B,GAAG,CAACM,IAAI,CAAC,CAAC;MACrB;MACA,OAAON,GAAG,CAACO,IAAI,CAAC,CAAC;IACrB,CAAC,CAAC,CAACR,IAAI,CAACC,GAAG,IAAI;MACX,IAAIvB,MAAM,IAAI,OAAO,IAAIJ,YAAY,EAAE;QACnCmB,YAAY,CAACgB,OAAO,CAAC,aAAa,EAAER,GAAG,CAAC;QACxCI,QAAQ,CAACC,IAAI,GAAG,sBAAsB;MAC1C;MACA,IAAIL,GAAG,CAACS,OAAO,EAAEP,KAAK,CAACF,GAAG,CAACS,OAAO,CAAC;MACnC,IAAIlC,MAAM,IAAI,KAAK,EAAE;QACjBmC,SAAS,CAACC,IAAI,CAAC,CAAC;QAChBC,CAAC,CAAC,UAAU,CAAC,CAACC,SAAS,CAAC,CAAC,CAACC,IAAI,CAACC,MAAM,CAAC,CAAC;MAC3C;MACA,OAAOC,OAAO,CAACC,OAAO,CAACjB,GAAG,CAAC;IAC/B,CAAC,CAAC,CAACD,IAAI,CAACC,GAAG,IAAI;MACX,IAAIzB,MAAM,IAAI,KAAK,EAAC;QAChB,QAAQE,MAAM;UACV,KAAK,WAAW;YACZyC,SAAS,CAAC,cAAc,EAAElB,GAAG,EAAC,IAAI,CAAC;YACnC;UACJ;YACI;QACR;MACJ;IACJ,CAAC,CAAC;EACN;AACJ;AACA,SAASkB,SAASA,CAACC,OAAO,EAAEC,KAAK,EAAErC,KAAK,EAAE;EACtC6B,CAAC,CAAC,GAAG,GAAGO,OAAO,GAAG,SAAS,CAAC,CAACE,MAAM,CAAC,CAAC,CAAC;EACtC,KAAKC,CAAC,IAAIF,KAAK,EAAE;IACb,IAAIG,QAAQ,GAAC,EAAE;IACf,IAAGxC,KAAK,IAAG,IAAI,IAAIqC,KAAK,CAACE,CAAC,CAAC,CAACE,IAAI,IAAEzC,KAAK,EAAEwC,QAAQ,GAAC,UAAU;IAC5DX,CAAC,CAAC,GAAG,GAAGO,OAAO,CAAC,CAACM,MAAM,CAAC,iBAAiB,GAACL,KAAK,CAACE,CAAC,CAAC,CAACE,IAAI,GAAC,IAAI,GAACD,QAAQ,GAAC,GAAG,GAAGH,KAAK,CAACE,CAAC,CAAC,CAACE,IAAI,GAAG,WAAW,CAAC;EAC5G;AACJ;AACA,SAASE,MAAMA,CAAA,EAAG;EACdlC,YAAY,CAACgB,OAAO,CAAC,aAAa,EAAE,EAAE,CAAC;AAC3C"}