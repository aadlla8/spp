{"version":3,"file":"spp.js","names":["baseUrl","registerUrl","loginUrl","loginsuccess","processForm","action","form","entity","classList","contains","checkValidity","url","id","value","fData","FormData","data","JSON","stringify","Object","fromEntries","requestHeader","localStorage","getItem","fetch","method","headers","body","then","res","ok","alert","status","location","href","text","json","console","log","setItem","message","editModal","hide","$","DataTable","ajax","reload"],"sources":["../../src/js/spp.js"],"sourcesContent":["var baseUrl = \"/api/v1/\";\nvar registerUrl = \"/auth/addNewUser\";\nvar loginUrl = \"/auth/generateToken\";\nvar loginsuccess = false;\nfunction processForm(action, form, entity) {\n    loginsuccess = false;\n    if (form.classList.contains('was-validated') && form.checkValidity()) {\n\n        let url = baseUrl + entity;\n        if (entity == 'register') url = registerUrl;\n        if (entity == 'login') url = loginUrl;\n        if (action == 'PUT') {\n            url += '/' + form.id.value;\n        }\n        let fData = new FormData(form);\n        let data = JSON.stringify(Object.fromEntries(fData));\n        let requestHeader= {\n            \"Content-Type\": \"application/json\",\n        };\n        if(entity !='login' && entity!='register'){\n            requestHeader= {\n                'crossorigin': true,   \n                'Access-Control-Allow-Origin': '*',\n                \"Content-Type\": \"application/json\",\n                \"Authorization\": \"Bearer \"+localStorage.getItem(\"accesstoken\")\n            };\n        }\n        fetch(url, {\n            method: action,\n            headers: requestHeader,\n            body: data                      \n        }).then((res) => {\n            if (res.ok) alert('Thành công');\n            if (res.status > 299) location.href = \"/login.html\";\n            if (res.ok && entity == 'login') {\n                loginsuccess = true;\n                return res.text();\n            }\n            return res.json();\n        }).then(res => {\n            console.log(res)\n            if (entity = 'login' && loginsuccess) {\n                localStorage.setItem(\"accesstoken\", res);\n                location.href='/base/list-jobs.html';\n            }\n            if (res.message) alert(res.message);\n            if (action == 'PUT') {\n                editModal.hide();\n                $('#example').DataTable().ajax.reload();\n            }\n        }\n        );\n    }\n\n}\n"],"mappings":"AAAA,IAAIA,OAAO,GAAG,UAAU;AACxB,IAAIC,WAAW,GAAG,kBAAkB;AACpC,IAAIC,QAAQ,GAAG,qBAAqB;AACpC,IAAIC,YAAY,GAAG,KAAK;AACxB,SAASC,WAAWA,CAACC,MAAM,EAAEC,IAAI,EAAEC,MAAM,EAAE;EACvCJ,YAAY,GAAG,KAAK;EACpB,IAAIG,IAAI,CAACE,SAAS,CAACC,QAAQ,CAAC,eAAe,CAAC,IAAIH,IAAI,CAACI,aAAa,CAAC,CAAC,EAAE;IAElE,IAAIC,GAAG,GAAGX,OAAO,GAAGO,MAAM;IAC1B,IAAIA,MAAM,IAAI,UAAU,EAAEI,GAAG,GAAGV,WAAW;IAC3C,IAAIM,MAAM,IAAI,OAAO,EAAEI,GAAG,GAAGT,QAAQ;IACrC,IAAIG,MAAM,IAAI,KAAK,EAAE;MACjBM,GAAG,IAAI,GAAG,GAAGL,IAAI,CAACM,EAAE,CAACC,KAAK;IAC9B;IACA,IAAIC,KAAK,GAAG,IAAIC,QAAQ,CAACT,IAAI,CAAC;IAC9B,IAAIU,IAAI,GAAGC,IAAI,CAACC,SAAS,CAACC,MAAM,CAACC,WAAW,CAACN,KAAK,CAAC,CAAC;IACpD,IAAIO,aAAa,GAAE;MACf,cAAc,EAAE;IACpB,CAAC;IACD,IAAGd,MAAM,IAAG,OAAO,IAAIA,MAAM,IAAE,UAAU,EAAC;MACtCc,aAAa,GAAE;QACX,aAAa,EAAE,IAAI;QACnB,6BAA6B,EAAE,GAAG;QAClC,cAAc,EAAE,kBAAkB;QAClC,eAAe,EAAE,SAAS,GAACC,YAAY,CAACC,OAAO,CAAC,aAAa;MACjE,CAAC;IACL;IACAC,KAAK,CAACb,GAAG,EAAE;MACPc,MAAM,EAAEpB,MAAM;MACdqB,OAAO,EAAEL,aAAa;MACtBM,IAAI,EAAEX;IACV,CAAC,CAAC,CAACY,IAAI,CAAEC,GAAG,IAAK;MACb,IAAIA,GAAG,CAACC,EAAE,EAAEC,KAAK,CAAC,YAAY,CAAC;MAC/B,IAAIF,GAAG,CAACG,MAAM,GAAG,GAAG,EAAEC,QAAQ,CAACC,IAAI,GAAG,aAAa;MACnD,IAAIL,GAAG,CAACC,EAAE,IAAIvB,MAAM,IAAI,OAAO,EAAE;QAC7BJ,YAAY,GAAG,IAAI;QACnB,OAAO0B,GAAG,CAACM,IAAI,CAAC,CAAC;MACrB;MACA,OAAON,GAAG,CAACO,IAAI,CAAC,CAAC;IACrB,CAAC,CAAC,CAACR,IAAI,CAACC,GAAG,IAAI;MACXQ,OAAO,CAACC,GAAG,CAACT,GAAG,CAAC;MAChB,IAAItB,MAAM,GAAG,OAAO,IAAIJ,YAAY,EAAE;QAClCmB,YAAY,CAACiB,OAAO,CAAC,aAAa,EAAEV,GAAG,CAAC;QACxCI,QAAQ,CAACC,IAAI,GAAC,sBAAsB;MACxC;MACA,IAAIL,GAAG,CAACW,OAAO,EAAET,KAAK,CAACF,GAAG,CAACW,OAAO,CAAC;MACnC,IAAInC,MAAM,IAAI,KAAK,EAAE;QACjBoC,SAAS,CAACC,IAAI,CAAC,CAAC;QAChBC,CAAC,CAAC,UAAU,CAAC,CAACC,SAAS,CAAC,CAAC,CAACC,IAAI,CAACC,MAAM,CAAC,CAAC;MAC3C;IACJ,CACA,CAAC;EACL;AAEJ"}